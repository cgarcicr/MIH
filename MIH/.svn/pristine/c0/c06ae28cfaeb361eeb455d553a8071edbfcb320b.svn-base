package com.sophos.semih.validator;

import java.util.Collections;
import java.util.HashMap;
import java.util.Map;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import javax.faces.application.FacesMessage;
import javax.faces.component.UIComponent;
import javax.faces.context.FacesContext;
import javax.faces.validator.FacesValidator;
import javax.faces.validator.Validator;
import javax.faces.validator.ValidatorException;

/**
 * Validador que permite identificar si una cadena puede ser el nombre de un
 * atributo en Oracle
 * 
 * @author sebastian.duque
 * 
 */
@FacesValidator("oracleValidator")
public class OracleObjectValidator implements Validator {
	private static final String regex = "^[A-Z]([\\w]|\\$|#){0,29}$";
	private Pattern pattern;
	private Matcher matcher;
	private Map<String, Object> palabrasReservadas;			

	/**
	 * Constructor
	 */
	public OracleObjectValidator() {
		pattern = Pattern.compile(regex);
		palabrasReservadas = obtenerMapa();
	}

	@Override
	public void validate(FacesContext context, UIComponent component,
			Object value) throws ValidatorException {
		if(palabrasReservadas.containsKey(value)){
			FacesMessage msg = new FacesMessage(
					"No se pudo validar el identificador", "El nombre no puede ser una palabra reservada por la base de datos.");
			msg.setSeverity(FacesMessage.SEVERITY_ERROR);
			throw new ValidatorException(msg);
		}
		
		matcher = pattern.matcher(value.toString());
		if (!matcher.matches()) {
			FacesMessage msg = new FacesMessage(
					"No se pudo validar el identificador", "El nombre contiene caracteres inv√°lidos o espacios");
			msg.setSeverity(FacesMessage.SEVERITY_ERROR);
			throw new ValidatorException(msg);
		}

	}

	/**
	 * Construye y entrega un mapa que contiene como llave las palabras
	 * reservadas por Oracle y que no pueden ser usadas como nombre de una tabla
	 * o campo 
	 * @return Mapa con las palabras reservadas
	 */
	private Map<String, Object> obtenerMapa() {
		Map<String, Object> result = new HashMap<String, Object>();
		result.put("ACCESS",null);
		result.put("ACCOUNT",null);
		result.put("ACTIVATE",null);
		result.put("ADD",null);
		result.put("ADMIN",null);
		result.put("ADVISE",null);
		result.put("AFTER",null);
		result.put("ALL",null);
		result.put("ALL_ROWS",null);
		result.put("ALLOCATE",null);
		result.put("ALTER",null);
		result.put("ANALYZE",null);
		result.put("AND",null);
		result.put("ANY",null);
		result.put("ARCHIVE",null);
		result.put("ARCHIVELOG",null);
		result.put("ARRAY",null);
		result.put("AS",null);
		result.put("ASC",null);
		result.put("AT",null);
		result.put("AUDIT",null);
		result.put("AUTHENTICATED",null);
		result.put("AUTHORIZATION",null);
		result.put("AUTOEXTEND",null);
		result.put("AUTOMATIC",null);
		result.put("BACKUP",null);
		result.put("BECOME",null);
		result.put("BEFORE",null);
		result.put("BEGIN",null);
		result.put("BETWEEN",null);
		result.put("BFILE",null);
		result.put("BITMAP",null);
		result.put("BLOB",null);
		result.put("BLOCK",null);
		result.put("BODY",null);
		result.put("BY",null);
		result.put("CACHE",null);
		result.put("CACHE_INSTANCES",null);
		result.put("CANCEL",null);
		result.put("CASCADE",null);
		result.put("CAST",null);
		result.put("CFILE",null);
		result.put("CHAINED",null);
		result.put("CHANGE",null);
		result.put("CHAR",null);
		result.put("CHAR_CS",null);
		result.put("CHARACTER",null);
		result.put("CHECK",null);
		result.put("CHECKPOINT",null);
		result.put("CHOOSE",null);
		result.put("CHUNK",null);
		result.put("CLEAR",null);
		result.put("CLOB",null);
		result.put("CLONE",null);
		result.put("CLOSE",null);
		result.put("CLOSE_CACHED_OPEN_CURSORS",null);
		result.put("CLUSTER",null);
		result.put("COALESCE",null);
		result.put("COLUMN",null);
		result.put("COLUMNS",null);
		result.put("COMMENT",null);
		result.put("COMMIT",null);
		result.put("COMMITTED",null);
		result.put("COMPATIBILITY",null);
		result.put("COMPILE",null);
		result.put("COMPLETE",null);
		result.put("COMPOSITE_LIMIT",null);
		result.put("COMPRESS",null);
		result.put("COMPUTE",null);
		result.put("CONNECT",null);
		result.put("CONNECT_TIME",null);
		result.put("CONSTRAINT",null);
		result.put("CONSTRAINTS",null);
		result.put("CONTENTS",null);
		result.put("CONTINUE",null);
		result.put("CONTROLFILE",null);
		result.put("CONVERT",null);
		result.put("COST",null);
		result.put("CPU_PER_CALL",null);
		result.put("CPU_PER_SESSION",null);
		result.put("CREATE",null);
		result.put("CURRENT",null);
		result.put("CURRENT_SCHEMA",null);
		result.put("CURREN_USER",null);
		result.put("CURSOR",null);
		result.put("CYCLE",null);
		result.put(" ",null);
		result.put("DANGLING",null);
		result.put("DATABASE",null);
		result.put("DATAFILE",null);
		result.put("DATAFILES",null);
		result.put("DATAOBJNO",null);
		result.put("DATE",null);
		result.put("DBA",null);
		result.put("DBHIGH",null);
		result.put("DBLOW",null);
		result.put("DBMAC",null);
		result.put("DEALLOCATE",null);
		result.put("DEBUG",null);
		result.put("DEC",null);
		result.put("DECIMAL",null);
		result.put("DECLARE",null);
		result.put("DEFAULT",null);
		result.put("DEFERRABLE",null);
		result.put("DEFERRED",null);
		result.put("DEGREE",null);
		result.put("DELETE",null);
		result.put("DEREF",null);
		result.put("DESC",null);
		result.put("DIRECTORY",null);
		result.put("DISABLE",null);
		result.put("DISCONNECT",null);
		result.put("DISMOUNT",null);
		result.put("DISTINCT",null);
		result.put("DISTRIBUTED",null);
		result.put("DML",null);
		result.put("DOUBLE",null);
		result.put("DROP",null);
		result.put("DUMP",null);
		result.put("EACH",null);
		result.put("ELSE",null);
		result.put("ENABLE",null);
		result.put("END",null);
		result.put("ENFORCE",null);
		result.put("ENTRY",null);
		result.put("ESCAPE",null);
		result.put("EXCEPT",null);
		result.put("EXCEPTIONS",null);
		result.put("EXCHANGE",null);
		result.put("EXCLUDING",null);
		result.put("EXCLUSIVE",null);
		result.put("EXECUTE",null);
		result.put("EXISTS",null);
		result.put("EXPIRE",null);
		result.put("EXPLAIN",null);
		result.put("EXTENT",null);
		result.put("EXTENTS",null);
		result.put("EXTERNALLY",null);
		result.put("FAILED_LOGIN_ATTEMPTS",null);
		result.put("FALSE",null);
		result.put("FAST",null);
		result.put("FILE",null);
		result.put("FIRST_ROWS",null);
		result.put("FLAGGER",null);
		result.put("FLOAT",null);
		result.put("FLOB",null);
		result.put("FLUSH",null);
		result.put("FOR",null);
		result.put("FORCE",null);
		result.put("FOREIGN",null);
		result.put("FREELIST",null);
		result.put("FREELISTS",null);
		result.put("FROM",null);
		result.put("FULL",null);
		result.put("FUNCTION",null);
		result.put("GLOBAL",null);
		result.put("GLOBALLY",null);
		result.put("GLOBAL_NAME",null);
		result.put("GRANT",null);
		result.put("GROUP",null);
		result.put("GROUPS",null);
		result.put("HASH",null);
		result.put("HASHKEYS",null);
		result.put("HAVING",null);
		result.put("HEADER",null);
		result.put("HEAP",null);
		result.put("IDENTIFIED",null);
		result.put("IDGENERATORS",null);
		result.put("IDLE_TIME",null);
		result.put("IF",null);
		result.put("IMMEDIATE",null);
		result.put("IN",null);
		result.put("INCLUDING",null);
		result.put("INCREMENT",null);
		result.put("INDEX",null);
		result.put("INDEXED",null);
		result.put("INDEXES",null);
		result.put("INDICATOR",null);
		result.put("IND_PARTITION",null);
		result.put("INITIAL",null);
		result.put("INITIALLY",null);
		result.put("INITRANS",null);
		result.put("INSERT",null);
		result.put("INSTANCE",null);
		result.put("INSTANCES",null);
		result.put("INSTEAD",null);
		result.put("INT",null);
		result.put("INTEGER",null);
		result.put("INTERMEDIATE",null);
		result.put("INTERSECT",null);
		result.put("INTO",null);
		result.put("IS",null);
		result.put("ISOLATION",null);
		result.put("ISOLATION_LEVEL",null);
		result.put("KEEP",null);
		result.put("KEY",null);
		result.put("KILL",null);
		result.put("LABEL",null);
		result.put("LAYER",null);
		result.put("LESS",null);
		result.put("LEVEL",null);
		result.put("LIBRARY",null);
		result.put("LIKE",null);
		result.put("LIMIT",null);
		result.put("LINK",null);
		result.put("LIST",null);
		result.put("LOB",null);
		result.put("LOCAL",null);
		result.put("LOCK",null);
		result.put("LOCKED",null);
		result.put("LOG",null);
		result.put("LOGFILE",null);
		result.put("LOGGING",null);
		result.put("LOGICAL_READS_PER_CALL",null);
		result.put("LOGICAL_READS_PER_SESSION",null);
		result.put("LONG",null);
		result.put("MANAGE",null);
		result.put("MASTER",null);
		result.put("MAX",null);
		result.put("MAXARCHLOGS",null);
		result.put("MAXDATAFILES",null);
		result.put("MAXEXTENTS",null);
		result.put("MAXINSTANCES",null);
		result.put("MAXLOGFILES",null);
		result.put("MAXLOGHISTORY",null);
		result.put("MAXLOGMEMBERS",null);
		result.put("MAXSIZE",null);
		result.put("MAXTRANS",null);
		result.put("MAXVALUE",null);
		result.put("MIN",null);
		result.put("MEMBER",null);
		result.put("MINIMUM",null);
		result.put("MINEXTENTS",null);
		result.put("MINUS",null);
		result.put("MINVALUE",null);
		result.put("MLSLABEL",null);
		result.put("MLS_LABEL_FORMAT",null);
		result.put("MODE",null);
		result.put("MODIFY",null);
		result.put("MOUNT",null);
		result.put("MOVE",null);
		result.put("MTS_DISPATCHERS",null);
		result.put("MULTISET",null);
		result.put("NATIONAL",null);
		result.put("NCHAR",null);
		result.put("NCHAR_CS",null);
		result.put("NCLOB",null);
		result.put("NEEDED",null);
		result.put("NESTED",null);
		result.put("NETWORK",null);
		result.put("NEW",null);
		result.put("NEXT",null);
		result.put("NOARCHIVELOG",null);
		result.put("NOAUDIT",null);
		result.put("NOCACHE",null);
		result.put("NOCOMPRESS",null);
		result.put("NOCYCLE",null);
		result.put("NOFORCE",null);
		result.put("NOLOGGING",null);
		result.put("NOMAXVALUE",null);
		result.put("NOMINVALUE",null);
		result.put("NONE",null);
		result.put("NOORDER",null);
		result.put("NOOVERRIDE",null);
		result.put("NOPARALLEL",null);
		result.put("NOPARALLEL",null);
		result.put("NOREVERSE",null);
		result.put("NORMAL",null);
		result.put("NOSORT",null);
		result.put("NOT",null);
		result.put("NOTHING",null);
		result.put("NOWAIT",null);
		result.put("NULL",null);
		result.put("NUMBER",null);
		result.put("NUMERIC",null);
		result.put("NVARCHAR2",null);
		result.put("OBJECT",null);
		result.put("OBJNO",null);
		result.put("OBJNO_REUSE",null);
		result.put("OF",null);
		result.put("OFF",null);
		result.put("OFFLINE",null);
		result.put("OID",null);
		result.put("OIDINDEX",null);
		result.put("OLD",null);
		result.put("ON",null);
		result.put("ONLINE",null);
		result.put("ONLY",null);
		result.put("OPCODE",null);
		result.put("OPEN",null);
		result.put("OPTIMAL",null);
		result.put("OPTIMIZER_GOAL",null);
		result.put("OPTION",null);
		result.put("OR",null);
		result.put("ORDER",null);
		result.put("ORGANIZATION",null);
		result.put("OSLABEL",null);
		result.put("OVERFLOW",null);
		result.put("OWN",null);
		result.put("PACKAGE",null);
		result.put("PARALLEL",null);
		result.put("PARTITION",null);
		result.put("PASSWORD",null);
		result.put("PASSWORD_GRACE_TIME",null);
		result.put("PASSWORD_LIFE_TIME",null);
		result.put("PASSWORD_LOCK_TIME",null);
		result.put("PASSWORD_REUSE_MAX",null);
		result.put("PASSWORD_REUSE_TIME",null);
		result.put("PASSWORD_VERIFY_FUNCTION",null);
		result.put("PCTFREE",null);
		result.put("PCTINCREASE",null);
		result.put("PCTTHRESHOLD",null);
		result.put("PCTUSED",null);
		result.put("PCTVERSION",null);
		result.put("PERCENT",null);
		result.put("PERMANENT",null);
		result.put("PLAN",null);
		result.put("PLSQL_DEBUG",null);
		result.put("POST_TRANSACTION",null);
		result.put("PRECISION",null);
		result.put("PRESERVE",null);
		result.put("PRIMARY",null);
		result.put("PRIOR",null);
		result.put("PRIVATE",null);
		result.put("PRIVATE_SGA",null);
		result.put("PRIVILEGE",null);
		result.put("PRIVILEGES",null);
		result.put("PROCEDURE",null);
		result.put("PROFILE",null);
		result.put("PUBLIC",null);
		result.put("PURGE",null);
		result.put("QUEUE",null);
		result.put("QUOTA",null);
		result.put("RANGE",null);
		result.put("RAW",null);
		result.put("RBA",null);
		result.put("READ",null);
		result.put("READUP",null);
		result.put("REAL",null);
		result.put("REBUILD",null);
		result.put("RECOVER",null);
		result.put("RECOVERABLE",null);
		result.put("RECOVERY",null);
		result.put("REF",null);
		result.put("REFERENCES",null);
		result.put("REFERENCING",null);
		result.put("REFRESH",null);
		result.put("RENAME",null);
		result.put("REPLACE",null);
		result.put("RESET",null);
		result.put("RESETLOGS",null);
		result.put("RESIZE",null);
		result.put("RESOURCE",null);
		result.put("RESTRICTED",null);
		result.put("RETURN",null);
		result.put("RETURNING",null);
		result.put("REUSE",null);
		result.put("REVERSE",null);
		result.put("REVOKE",null);
		result.put("ROLE",null);
		result.put("ROLES",null);
		result.put("ROLLBACK",null);
		result.put("ROW",null);
		result.put("ROWID",null);
		result.put("ROWNUM",null);
		result.put("ROWS",null);
		result.put("RULE",null);
		result.put("SAMPLE",null);
		result.put("SAVEPOINT",null);
		result.put("SB4",null);
		result.put("SCAN_INSTANCES",null);
		result.put("SCHEMA",null);
		result.put("SCN",null);
		result.put("SCOPE",null);
		result.put("SD_ALL",null);
		result.put("SD_INHIBIT",null);
		result.put("SD_SHOW",null);
		result.put("SEGMENT",null);
		result.put("SEG_BLOCK",null);
		result.put("SEG_FILE",null);
		result.put("SELECT",null);
		result.put("SEQUENCE",null);
		result.put("SERIALIZABLE",null);
		result.put("SESSION",null);
		result.put("SESSION_CACHED_CURSORS",null);
		result.put("SESSIONS_PER_USER",null);
		result.put("SET",null);
		result.put("SHARE",null);
		result.put("SHARED",null);
		result.put("SHARED_POOL",null);
		result.put("SHRINK",null);
		result.put("SIZE",null);
		result.put("SKIP",null);
		result.put("SKIP_UNUSABLE_INDEXES",null);
		result.put("SMALLINT",null);
		result.put("SNAPSHOT",null);
		result.put("SOME",null);
		result.put("SORT",null);
		result.put("SPECIFICATION",null);
		result.put("SPLIT",null);
		result.put("SQL_TRACE",null);
		result.put("STANDBY",null);
		result.put("START",null);
		result.put("STATEMENT_ID",null);
		result.put("STATISTICS",null);
		result.put("STOP",null);
		result.put("STORAGE",null);
		result.put("STORE",null);
		result.put("STRUCTURE",null);
		result.put("SUCCESSFUL",null);
		result.put("SWITCH",null);
		result.put("SYS_OP_ENFORCE_NOT_NULL$",null);
		result.put("SYS_OP_NTCIMG$",null);
		result.put("SYNONYM",null);
		result.put("SYSDATE",null);
		result.put("SYSDBA",null);
		result.put("SYSOPER",null);
		result.put("SYSTEM",null);
		result.put("TABLE",null);
		result.put("TABLES",null);
		result.put("TABLESPACE",null);
		result.put("TABLESPACE_NO",null);
		result.put("TABNO",null);
		result.put("TEMPORARY",null);
		result.put("THAN",null);
		result.put("THE",null);
		result.put("THEN",null);
		result.put("THREAD",null);
		result.put("TIMESTAMP",null);
		result.put("TIME",null);
		result.put("TO",null);
		result.put("TOPLEVEL",null);
		result.put("TRACE",null);
		result.put("TRACING",null);
		result.put("TRANSACTION",null);
		result.put("TRANSITIONAL",null);
		result.put("TRIGGER",null);
		result.put("TRIGGERS",null);
		result.put("TRUE",null);
		result.put("TRUNCATE",null);
		result.put("TX",null);
		result.put("TYPE",null);
		result.put("UB2",null);
		result.put("UBA",null);
		result.put("UID",null);
		result.put("UNARCHIVED",null);
		result.put("UNDO",null);
		result.put("UNION",null);
		result.put("UNIQUE",null);
		result.put("UNLIMITED",null);
		result.put("UNLOCK",null);
		result.put("UNRECOVERABLE",null);
		result.put("UNTIL",null);
		result.put("UNUSABLE",null);
		result.put("UNUSED",null);
		result.put("UPDATABLE",null);
		result.put("UPDATE",null);
		result.put("USAGE",null);
		result.put("USE",null);
		result.put("USER",null);
		result.put("USING",null);
		result.put("VALIDATE",null);
		result.put("VALIDATION",null);
		result.put("VALUE",null);
		result.put("VALUES",null);
		result.put("VARCHAR",null);
		result.put("VARCHAR2",null);
		result.put("VARYING",null);
		result.put("VIEW",null);
		result.put("WHEN",null);
		result.put("WHENEVER",null);
		result.put("WHERE",null);
		result.put("WITH",null);
		result.put("WITHOUT",null);
		result.put("WORK",null);
		result.put("WRITE",null);
		result.put("WRITEDOWN",null);
		result.put("WRITEUP",null);
		result.put("XID",null);
		result.put("YEAR",null);
        return Collections.unmodifiableMap(result);
	}

}
